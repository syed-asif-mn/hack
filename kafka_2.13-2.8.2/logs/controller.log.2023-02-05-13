[2023-02-05 13:04:00,007] WARN [RequestSendThread controllerId=0] Controller 0 epoch 2 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=2, brokerEpoch=45, partitionStates=[LeaderAndIsrPartitionState(topicName='pizza', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='sample1', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={pizza=cE6iqiHpSv--QegY9e0Cng, sample1=lryTAkoGRiC-44ZmkfQNlw}, liveLeaders=(ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null))) to broker ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:253)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 13:04:00,007] ERROR [Controller id=0] Error while electing or becoming controller on broker 0. Trigger controller movement immediately (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /admin/reassign_partitions
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:576)
	at kafka.zk.KafkaZkClient.registerZNodeChangeHandlerAndCheckExistence(KafkaZkClient.scala:1453)
	at kafka.controller.KafkaController.processZkPartitionReassignment(KafkaController.scala:1771)
	at kafka.controller.KafkaController.initializePartitionReassignments(KafkaController.scala:957)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1520)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2397)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2402)
	at kafka.controller.KafkaController.process(KafkaController.scala:2444)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 13:04:01,311] INFO [RequestSendThread controllerId=0] Controller 0 connected to ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-02-05 13:04:01,684] ERROR [Controller id=0] Error processing event RegisterBrokerAndReelect (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /controller
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:576)
	at kafka.zk.KafkaZkClient.getControllerId(KafkaZkClient.scala:1113)
	at kafka.controller.KafkaController.triggerControllerMove(KafkaController.scala:1474)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2397)
	at kafka.controller.KafkaController.processRegisterBrokerAndReelect(KafkaController.scala:2402)
	at kafka.controller.KafkaController.process(KafkaController.scala:2444)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2023-02-05 13:04:01,771] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-02-05 13:04:01,776] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:04:01,776] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:04:01,776] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:04:01,776] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2023-02-05 13:04:01,811] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2023-02-05 13:04:01,813] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2023-02-05 13:04:01,950] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2023-02-05 13:04:02,615] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 3 and epoch zk version is now 3 (kafka.controller.KafkaController)
[2023-02-05 13:04:02,637] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2023-02-05 13:04:02,646] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2023-02-05 13:04:02,647] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2023-02-05 13:04:02,652] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2023-02-05 13:04:02,685] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 49) (kafka.controller.KafkaController)
[2023-02-05 13:04:02,707] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:04:02,755] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2023-02-05 13:04:02,968] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:04:03,019] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2023-02-05 13:04:03,034] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2023-02-05 13:04:03,044] INFO [Controller id=0] Current list of topics in the cluster: HashSet(sample1, pizza) (kafka.controller.KafkaController)
[2023-02-05 13:04:03,044] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2023-02-05 13:04:03,258] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,276] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,280] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2023-02-05 13:04:03,302] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2023-02-05 13:04:03,302] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2023-02-05 13:04:03,322] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:04:03,322] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:04:03,377] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:04:03,383] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=pizza,Partition=0,Replica=0] -> OnlineReplica, [Topic=sample1,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:04:03,392] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:04:03,435] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:04:03,447] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(pizza-0 -> OnlinePartition, sample1-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:04:03,452] INFO [Controller id=0] Ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2023-02-05 13:04:03,614] INFO [RequestSendThread controllerId=0] Controller 0 connected to ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-02-05 13:04:03,679] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,679] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,679] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,679] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2023-02-05 13:04:03,684] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2023-02-05 13:04:03,932] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2023-02-05 13:04:09,802] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:04:10,283] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:04:12,081] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:04:12,297] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:09:13,480] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:09:14,700] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:09:21,044] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:09:21,345] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:14:35,927] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:14:35,937] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:14:35,956] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:14:35,961] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:14:35,997] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-02-05 13:14:35,998] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:14:35,999] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:14:36,006] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:14:36,006] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2023-02-05 13:14:36,010] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2023-02-05 13:14:36,010] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2023-02-05 13:14:36,099] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2023-02-05 13:14:36,138] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 4 and epoch zk version is now 4 (kafka.controller.KafkaController)
[2023-02-05 13:14:36,141] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2023-02-05 13:14:36,152] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2023-02-05 13:14:36,153] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2023-02-05 13:14:36,154] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2023-02-05 13:14:36,157] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 54) (kafka.controller.KafkaController)
[2023-02-05 13:14:36,164] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:14:36,176] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2023-02-05 13:14:36,178] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:14:36,178] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2023-02-05 13:14:36,178] INFO [Controller id=0] Current list of topics in the cluster: HashSet(sample1, pizza) (kafka.controller.KafkaController)
[2023-02-05 13:14:36,178] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2023-02-05 13:14:36,185] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2023-02-05 13:14:36,193] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,193] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,193] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2023-02-05 13:14:36,193] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2023-02-05 13:14:36,193] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2023-02-05 13:14:36,195] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:14:36,195] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:14:36,199] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:14:36,199] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=pizza,Partition=0,Replica=0] -> OnlineReplica, [Topic=sample1,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:14:36,199] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:14:36,199] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:14:36,199] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(pizza-0 -> OnlinePartition, sample1-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:14:36,199] INFO [Controller id=0] Ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2023-02-05 13:14:36,208] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,208] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,208] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,208] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2023-02-05 13:14:36,208] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2023-02-05 13:14:36,210] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2023-02-05 13:14:36,218] INFO [RequestSendThread controllerId=0] Controller 0 connected to ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-02-05 13:14:41,210] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:14:41,210] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:14:41,211] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:14:41,211] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:19:41,211] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:19:41,211] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:19:41,211] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:19:41,211] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:24:41,212] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:24:41,212] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:24:41,212] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:24:41,212] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:29:41,212] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:29:41,212] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:29:41,213] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:29:41,213] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:34:41,213] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:34:41,213] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:34:41,213] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:34:41,213] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:36:17,024] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2023-02-05 13:37:22,511] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2023-02-05 13:37:22,511] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2023-02-05 13:37:22,512] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2023-02-05 13:37:22,552] TRACE [Controller id=0] All leaders = pizza-0 -> (Leader:0,ISR:0,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),sample1-0 -> (Leader:0,ISR:0,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2023-02-05 13:37:23,771] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-02-05 13:37:23,771] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-02-05 13:37:23,771] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-02-05 13:37:23,771] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2023-02-05 13:37:23,774] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:37:23,775] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:37:23,775] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:37:23,776] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2023-02-05 13:37:23,776] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2023-02-05 13:37:23,776] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2023-02-05 13:37:23,777] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2023-02-05 13:46:36,360] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2023-02-05 13:48:34,579] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2023-02-05 13:48:34,614] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2023-02-05 13:48:34,619] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(Enabled,Features{}) (kafka.controller.KafkaController)
[2023-02-05 13:48:34,683] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2023-02-05 13:48:34,688] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2023-02-05 13:48:34,692] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2023-02-05 13:48:34,698] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2023-02-05 13:48:34,731] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2023-02-05 13:48:34,745] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:48:34,750] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2023-02-05 13:48:34,768] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2023-02-05 13:48:34,768] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2023-02-05 13:48:34,769] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2023-02-05 13:48:34,769] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2023-02-05 13:48:34,771] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,772] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,772] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2023-02-05 13:48:34,772] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2023-02-05 13:48:34,773] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2023-02-05 13:48:34,778] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2023-02-05 13:48:34,804] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:48:34,805] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:48:34,808] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:48:34,808] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2023-02-05 13:48:34,809] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:48:34,809] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:48:34,812] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2023-02-05 13:48:34,812] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2023-02-05 13:48:34,818] INFO [RequestSendThread controllerId=0] Controller 0 connected to ip-172-31-22-154.ec2.internal:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2023-02-05 13:48:34,818] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,818] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,819] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,819] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2023-02-05 13:48:34,820] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2023-02-05 13:48:34,834] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2023-02-05 13:48:39,835] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:48:39,836] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:49:17,648] INFO [Controller id=0] New topics: [Set(sample1)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(sample1,Some(mKswH20uSjuDzqfrNZb35g),Map(sample1-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2023-02-05 13:49:17,649] INFO [Controller id=0] New partition creation callback for sample1-0 (kafka.controller.KafkaController)
[2023-02-05 13:53:39,839] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:53:39,839] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:53:39,841] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:53:39,842] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2023-02-05 13:58:39,842] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2023-02-05 13:58:39,842] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2023-02-05 13:58:39,843] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2023-02-05 13:58:39,843] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
